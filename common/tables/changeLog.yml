databaseChangeLog:
  - preConditions:
    - dbms:
        type: oracle

  - changeSet:
      author: drsteini
      id: "create.table.act_metric"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: act_metric
      changes:
        - sqlFile:
            path: actMetric/actMetric.sql
            relativeToChangelogFile: true
        - rollback: drop table act_metric cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.act_metric.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'ACT_METRIC' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: actMetric/actMetricExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table act_metric merge partitions act_metric_stewards, act_metric_nwis, act_metric_storet, act_metric_biodata, act_metric_garbage into partition act_metric_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.activity"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: activity
      changes:
        - sqlFile:
            path: activity/activity.sql
            relativeToChangelogFile: true
        - rollback: drop table activity cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.activity.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'ACTIVITY' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: activity/activityExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table activity merge partitions activity_stewards, activity_nwis, activity_storet, activity_biodata, activity_garbage into partition activity_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.activity_sum"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: activity_sum
      changes:
        - sqlFile:
            path: activitySum/activitySum.sql
            relativeToChangelogFile: true
        - rollback: drop table activity_sum cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.activity_sum.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'ACTIVITY_SUM' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: activitySum/activitySumExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table activity_sum merge partitions activity_sum_stewards, activity_sum_nwis, activity_sum_storet, activity_sum_biodata, activity_sum_garbage into partition activity_sum_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.assemblage"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: assemblage
      changes:
        - sqlFile:
            path: assemblage/assemblage.sql
            relativeToChangelogFile: true
        - rollback: drop table assemblage cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.assemblage.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'ASSEMBLAGE' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: assemblage/assemblageExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table assemblage merge partitions assemblage_stewards, assemblage_nwis, assemblage_storet, assemblage_biodata, assemblage_garbage into partition assemblage_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.char_name"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: char_name
      changes:
        - sqlFile:
            path: charName/charName.sql
            relativeToChangelogFile: true
        - rollback: drop table char_name cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.char_name.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'CHAR_NAME' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: charName/charNameExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table char_name merge partitions char_name_stewards, char_name_nwis, char_name_storet, char_name_biodata, char_name_garbage into partition char_name_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.char_type"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: char_type
      changes:
        - sqlFile:
            path: charType/charType.sql
            relativeToChangelogFile: true
        - rollback: drop table char_type cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.char_type.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'CHAR_TYPE' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: charType/charTypeExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table char_type merge partitions char_type_stewards, char_type_nwis, char_type_storet, char_type_biodata, char_type_garbage into partition char_type_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.country"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: country
      changes:
        - sqlFile:
            path: country/country.sql
            relativeToChangelogFile: true
        - rollback: drop table country cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.country.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'COUNTRY' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: country/countryExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table country merge partitions country_stewards, country_nwis, country_storet, country_biodata, country_garbage into partition country_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.county"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: county
      changes:
        - sqlFile:
            path: county/county.sql
            relativeToChangelogFile: true
        - rollback: drop table county cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.county.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'COUNTY' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: county/countyExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table county merge partitions county_stewards, county_nwis, county_storet, county_biodata, county_garbage into partition county_garbage;

  - changeSet:
      author: drsteini
      id: "create.table.us_counties_dis_20121015"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: us_counties_dis_20121015
      changes:
        - sqlFile:
            path: county/usCountiesDis20121015.sql
            relativeToChangelogFile: true
        - rollback: drop table us_counties_dis_20121015 cascade constraints purge;


  - changeSet:
      author: drsteini
      id: "create.table.data_source"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: data_source
      changes:
        - sqlFile:
            path: dataSource/dataSource.sql
            relativeToChangelogFile: true
        - rollback: drop table data_source cascade constraints purge;


  - changeSet:
      author: drsteini
      id: "create.table.etl_threshold"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: etl_threshold
      changes:
        - sqlFile:
            path: etlThreshold/etlThreshold.sql
            relativeToChangelogFile: true
        - rollback: drop table etl_threshold cascade constraints purge;


  - changeSet:
      author: drsteini
      id: "create.table.huc8_conus_hi_ak_pr_dis"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: huc8_conus_hi_ak_pr_dis
      changes:
        - sqlFile:
            path: huc/huc8ConusHiAkPrDis.sql
            relativeToChangelogFile: true
        - rollback: drop table huc8_conus_hi_ak_pr_dis cascade constraints purge;


  - changeSet:
      author: drsteini
      id: "create.table.last_etl"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: last_etl
      changes:
        - sqlFile:
            path: lastEtl/lastEtl.sql
            relativeToChangelogFile: true
        - rollback: drop table last_etl cascade constraints purge;


  - changeSet:
      author: drsteini
      id: "create.table.organization"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: organization
      changes:
        - sqlFile:
            path: organization/organization.sql
            relativeToChangelogFile: true
        - rollback: drop table organization cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.organization.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'ORGANIZATION' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: organization/organizationExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table organization merge partitions organization_stewards, organization_nwis, organization_storet, organization_biodata, organization_garbage into partition organization_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.project"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: project
      changes:
        - sqlFile:
            path: project/project.sql
            relativeToChangelogFile: true
        - rollback: drop table project cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.project.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'PROJECT' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: project/projectExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table project merge partitions project_stewards, project_nwis, project_storet, project_biodata, project_garbage into partition project_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.project_dim"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: project_dim
      changes:
        - sqlFile:
            path: projectDim/projectDim.sql
            relativeToChangelogFile: true
        - rollback: drop table project_dim cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.project_dim.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'PROJECT_DIM' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: projectDim/projectDimExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table project_dim merge partitions project_dim_stewards, project_dim_nwis, project_dim_storet, project_dim_biodata, project_dim_garbage into partition project_dim_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.public_srsnames_00000"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: public_srsnames_00000
      changes:
        - sqlFile:
            path: publicSrsnames/publicSrsnames.sql
            relativeToChangelogFile: true
        - rollback: drop table public_srsnames_00000 cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.public_srsnames_test"
      context: ci
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: public_srsnames_test
      changes:
        - sqlFile:
            path: publicSrsnames/publicSrsnamesTest.sql
            relativeToChangelogFile: true
        - rollback: drop table public_srsnames_test cascade constraints purge;


  - changeSet:
      author: drsteini
      id: "create.table.qwportal_summary"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: qwportal_summary
      changes:
        - sqlFile:
            path: qwportalSummary/qwportalSummary.sql
            relativeToChangelogFile: true
        - rollback: drop table qwportal_summary cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.qwportal_summary.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'QWPORTAL_SUMMARY' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: qwportalSummary/qwportalSummaryExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table qwportal_summary merge partitions summary_stewards, summary_nwis, summary_storet, summary_biodata, summary_garbage into partition summary_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.r_detect_qnt_lmt"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: r_detect_qnt_lmt
      changes:
        - sqlFile:
            path: rDetectQntLmt/rDetectQntLmt.sql
            relativeToChangelogFile: true
        - rollback: drop table r_detect_qnt_lmt cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.r_detect_qnt_lmt.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'R_DETECT_QNT_LMT' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: rDetectQntLmt/rDetectQntLmtExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table r_detect_qnt_lmt merge partitions rdtct_qnt_lmt_stewards, rdtct_qnt_lmt_nwis, rdtct_qnt_lmt_storet, rdtct_qnt_lmt_biodata, rdtct_qnt_lmt_garbage into partition rdtct_qnt_lmt_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.result"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: result
      changes:
        - sqlFile:
            path: result/result.sql
            relativeToChangelogFile: true
        - rollback: drop table result cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.result.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'RESULT' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: result/resultExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table result merge partitions result_stewards, result_nwis, result_storet, result_biodata, result_garbage into partition result_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.result_sum"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: result_sum
      changes:
        - sqlFile:
            path: resultSum/resultSum.sql
            relativeToChangelogFile: true
        - rollback: drop table result_sum cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.result_sum.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'RESULT_SUM' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: resultSum/resultSumExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table result_sum merge partitions result_sum_stewards, result_sum_nwis, result_sum_storet, result_sum_biodata, result_sum_garbage into partition result_sum_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.sample_media"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: sample_media
      changes:
        - sqlFile:
            path: sampleMedia/sampleMedia.sql
            relativeToChangelogFile: true
        - rollback: drop table sample_media cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.sample_media.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'SAMPLE_MEDIA' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: sampleMedia/sampleMediaExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table sample_media merge partitions sample_media_stewards, sample_media_nwis, sample_media_storet, sample_media_biodata, sample_media_garbage into partition sample_media_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.site_type"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: site_type
      changes:
        - sqlFile:
            path: siteType/siteType.sql
            relativeToChangelogFile: true
        - rollback: drop table site_type cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.site_type.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'SITE_TYPE' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: siteType/siteTypeExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table site_type merge partitions site_type_stewards, site_type_nwis, site_type_storet, site_type_biodata, site_type_garbage into partition site_type_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.state"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: state
      changes:
        - sqlFile:
            path: state/state.sql
            relativeToChangelogFile: true
        - rollback: drop table state cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.state.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'STATE' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: state/stateExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table state merge partitions state_stewards, state_nwis, state_storet, state_biodata, state_garbage into partition state_garbage;

  - changeSet:
      author: drsteini
      id: "create.table.states"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: states
      changes:
        - sqlFile:
            path: state/states.sql
            relativeToChangelogFile: true
        - rollback: drop table states cascade constraints purge;


  - changeSet:
      author: drsteini
      id: "create.table.station"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: station
      changes:
        - sqlFile:
            path: station/station.sql
            relativeToChangelogFile: true
        - rollback: drop table station cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.station.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'STATION' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: station/stationExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table station merge partitions station_stewards, station_nwis, station_storet, station_biodata, station_garbage into partition station_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.station_sum"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: station_sum
      changes:
        - sqlFile:
            path: stationSum/stationSum.sql
            relativeToChangelogFile: true
        - rollback: drop table station_sum cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.station_sum.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'STATION_SUM' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: stationSum/stationSumExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table station_sum merge partitions station_sum_stewards, station_sum_nwis, station_sum_storet, station_sum_biodata, station_sum_garbage into partition station_sum_garbage;


  - changeSet:
      author: drsteini
      id: "create.table.taxa_name"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: taxa_name
      changes:
        - sqlFile:
            path: taxaName/taxaName.sql
            relativeToChangelogFile: true
        - rollback: drop table taxa_name cascade constraints purge;

  - changeSet:
      author: drsteini
      id: "create.table.taxa_name.partitions.external"
      context: external
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 1
            sql: select count(*) from user_objects where object_name = 'TAXA_NAME' and object_type = 'TABLE PARTITION';
      changes:
        - sqlFile:
            path: taxaName/taxaNameExternalPartitions.sql
            relativeToChangelogFile: true
        - rollback: alter table taxa_name merge partitions taxa_name_stewards, taxa_name_nwis, taxa_name_storet, taxa_name_biodata, taxa_name_garbage into partition taxa_name_garbage;


  - changeSet:
      author: drsteini
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - not:
          - tableExists:
              tableName: web_service_log
      id: "create.table.web_service_log"
      changes:
        - sqlFile:
            path: webServiceLog/webServiceLog.sql
            relativeToChangelogFile: true
        - rollback: drop table web_service_log cascade constraints purge;
